#!/usr/bin/env nix-shell
#!nix-shell -I nixpkgs=https://github.com/NixOS/nixpkgs/archive/f366af7a1b3891d9370091ab03150d3a6ee138fa.tar.gz -i zsh ./shell.nix

set -e
set -u
set -o pipefail

dir=$(dirname $0)

while [[ $1 =~ ^- ]]; do
  case $1 in
    # ignore `-O` so this operates in line with other `run` scripts
    -O)
      shift
      ;;
  esac
done

day=$(printf '%02d' $1)
shift
if [[ $# -gt 0 ]]; then
  part=${1:-}
  shift
fi

if (( ${+part} )); then
  name="AOC_${day}_${part}"
else
  name="AOC_${day}"
fi

time swipl "${dir}/${name}.pl" $@
